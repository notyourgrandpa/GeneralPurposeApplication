<h1 mat-dialog-title>{{title}}</h1>
<p *ngIf="id && !inventoryLog"><em>Loadingâ€¦</em></p>

<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <mat-dialog-content>
    <!-- Product -->
    <mat-form-field *ngIf="products | async as result">
      <mat-label>Select a Product...</mat-label>
      <mat-select id="productId" formControlName="productId"
                  (selectionChange)="onProductSelected($event.value)">
        <mat-option *ngFor="let product of result" [value]="product.id">
          {{product.name}}
        </mat-option>
      </mat-select>
      <mat-error *ngFor="let error of getErrors(form.get('productId')!,'Product')">
        {{error}}
      </mat-error>
    </mat-form-field>

    <!-- Stock info (read-only) -->
    <div *ngIf="selectedProductStock !== null" class="stock-info">
      <strong>Available stock:</strong> {{selectedProductStock}}
    </div>


    <!-- Quantity -->
    <mat-form-field>
      <mat-label>Quantity:</mat-label>
      <input matInput formControlName="quantity" required
            placeholder="Insert quantity">
      <mat-error *ngFor="let error of getErrors(form.get('quantity')!,'Quantity',
                { 'pattern' : 'requires a positive or negative number with 0-2 decimal values.'})">
        {{error}}
      </mat-error>
    </mat-form-field>

    <!-- Change Type -->
    <mat-form-field>
      <mat-label>Select change type...</mat-label>
      <mat-select id="changeType" formControlName="changeType">
        <mat-option [value]="1">StockIn</mat-option>
        <mat-option [value]="2">StockOut</mat-option>
        <mat-option [value]="3">Adjustment</mat-option>
      </mat-select>
      <mat-error *ngFor="let error of getErrors(form.get('changeType')!,'Change Type')">
        {{error}}
      </mat-error>
    </mat-form-field>

    <!-- Remarks -->
    <mat-form-field>
      <mat-label>Remarks:</mat-label>
      <input matInput formControlName="remarks" required
            placeholder="Insert remarks">
      <mat-error *ngFor="let error of getErrors(form.get('remarks')!,'Remarks')">
        {{error}}
      </mat-error>
    </mat-form-field>
  </mat-dialog-content>
  <mat-dialog-actions>
    <button mat-flat-button color="primary"
        type="submit"
        [disabled]="!form.valid">
      {{ this.id ? "Void" : "Create" }}
    </button>
    <button mat-flat-button color="secondary"
            mat-dialog-close>
      Cancel
    </button>
  </mat-dialog-actions>
</form>


<!-- Form debug info panel -->
<!--<div class="info">
  <div class="info-header">Form Debug Info</div>
  <div class="info-body">
    <div class="info-label">
      Form Value:
    </div>
    <div class="info-value">
      {{ form.value | json }}
    </div>
    <hr />
    <div class="info-label">
      Form Status:
    </div>
    <div class="info-value">
      {{ form.status | json }}
    </div>
  </div>
</div>-->
<!-- Form activity log panel -->
<!--<div class="info">
  <div class="info-header">Form Activity Log</div>
  <div class="info-body">
    <div class="info-value">
      <span *ngIf="activityLog"
            [innerHTML]="activityLog">
      </span>
    </div>
  </div>
</div>-->
